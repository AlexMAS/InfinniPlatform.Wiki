---
layout: default
title: DotNotation
position: 4
categories: 
tags: 
---

[Общие правила](#rules)

[Типы привязок](#bindingtypes)

[Примеры привязок](#bindingexamples)

[Привязки в шаблонах](#templatebindings)

   

#### Общие правила

Объекты системы имеют сложную структуру, с множеством вложенных объектов и коллекций. Структура каждого объекта системы описана в соответствующей конфигурации (правила описания модели данных см. в разделе [[DataSchema]]). Для адресации свойств объекта используется *точечная нотация (dot notation)*, правила которой определены ниже.

 

1. Доступ к свойству объекта:

```
<property>
```

где *<property>* - наименование свойства объекта.

 

2. Доступ к свойству вложенного объекта:

```
<subobject>.<property>
```

где *<subobject>* - наименование свойства объекта, в котором хранится вложенный объект; *<property>* - наименование свойства вложенного объекта.

 

3. Доступ к элементу коллекции:

```
<array>.<index>
```

где *<array>* - наименование коллекции; *<index>* - индекс элемента коллекции, отсчитываемый от 0, либо символ "$", который означает любой элемент коллекции.

 

4. Возможны различные комбинации указанных выше правил.

 

#### Типы привязок

Используя [[PropertyBinding]] элементы представления могут ссылаться на источник данных, его элементы или свойства элементов.

Таким образом, при адресации данных в представлении можно выделить следующие основные типы привязок, которые задают базовый объект для ссылки:

* Привязка к источнику данных ([[BaseDataSource]].GetItems()).
* Привязка к выделенному элементу ([[BaseDataSource]].GetSelectedItem()).
* Привязка к элементу с заданным индексом ([[BaseDataSource]].GetItems()[*index*]).

   

Ниже приведены примеры записи [[PropertyBinding]] для каждого их основных типов привязок. Привязка к источнику данных чаще всего используется элементами списков (например, [[ListBox]], [[ComboBox]], [[TreeView]], [[DataGrid]]). В данном случае свойство "Property" может отсутствовать, быть равным пустой строке ("") или пустому указателю (null).

```
{
	"DataSource": "PatientDataSource",
	"Property": ""
} 
```

   

Привязка к выделенному элементу обычно используется в том случае, если соответствующий элемент представления связан с выделенным элементом источника данных (а не с отдельными его свойствами). В чистом виде эта привязка чаще всего не используется; в большинстве случаев она используется в качестве базиса для адресации отдельных свойств выделенного элемента (примеры будут приведены ниже). Для адресации выделенного элемента используется символ "$".

```
{
	"DataSource": "PatientDataSource",
	"Property": "$"
}
```

   

Привязка к элементу с заданным индексом полностью аналогична предыдущей привязке, но связанна с определенным элементом коллекции. Для адресации элемента используется его порядковый индекс.

```
{
	"DataSource": "PatientDataSource",
	"Property": "7"
}
```

   

#### Примеры привязок

Ниже приведены примеры записи [[PropertyBinding]] с использованием основных типов привязок. Можно заметить, что для адресации вложенных свойств и коллекций используется все та же точечная нотация, а символ "$" означает выделенных элемент соответствующей коллекции (выделенный элемент коллекции источника данных или вложенной коллекции, за которой следует этот символ).

```
// 1. Адресация всей коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": ""
}
   
// 2. Адресация выделенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "$"
}
   
// 2.1. Адресация свойства выделенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "$.FirstName"
}
   
// 2.2. Адресация вложенного свойства выделенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "$.Sex.DisplayName"
}
   
// 2.3. Адресация вложенной коллекции выделенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "$.Policies"
}
   
{
	"DataSource": "PatientDataSource",
	"Property": "$.Policies.$"
}
   
{
	"DataSource": "PatientDataSource",
	"Property": "$.Policies.$.Number"
}
   
{
	"DataSource": "PatientDataSource",
	"Property": "$.Policies.5.Number"
}
 
// 3. Адресация определенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "7"
}
   
// 3.1. Адресация свойства определенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "7.FirstName"
}
   
// 3.2. Адресация вложенного свойства определенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "7.Sex.DisplayName"
}
   
// 3.3. Адресация вложенной коллекции определенного элемента коллекции источника данных
   
{
	"DataSource": "PatientDataSource",
	"Property": "7.Policies"
}
   
{
	"DataSource": "PatientDataSource",
	"Property": "7.Policies.$"
}
   
{
	"DataSource": "PatientDataSource",
	"Property": "7.Policies.$.Number"
}
   
{
	"DataSource": "PatientDataSource",
	"Property": "7.Policies.5.Number"
}
```

 

#### Привязки в шаблонах

Метаданные элементов списков (например, [[ListBox]], [[ComboBox]], [[TreeView]], [[DataGrid]]) могут иметь определение шаблона отображения элемента данных (например, [[ListBox]].ItemTemplate). Шаблон отображения элемента данных определяет дерево элементов представления для отображения элемента данных списка. Естественно, что элементы шаблона могут использовать привязку данных, чтобы отображать отдельные свойства элементов данных. Поскольку количество элементов данных, отображаемых в списке, заранее не определено, в привязках шаблона невозможно указать индекс определенного элемента данных, так как он определяется автоматически, в момент отображения списка. В связи с этим, в шаблонах отображения элементов данных для адресации любого элемента используется символ "$". В момент отображения списка для каждого элемента данных, используя шаблон, создается соответствующий визуальный элемент, в котором во всех привязках символ "$" динамически заменяется на индекс соответствующего элемента данных. После этого механизм привязки данных работает [[стандартным образом|Привязка к данным]].

Ниже приведен пример отображения адресной информации пациента в виде списка ([[ListBox]]), где каждому элементу данных сопоставлен шаблон отображения (ItemTemplate). Привязки данных, определенные в шаблоне, для адресации элементов списка используют символ "$".

```
{
	"Name": "ListBox1",
	"ItemTemplate": {
		"GridPanel": {
		    "Rows": [
        		{
		            "Cells": [
        		        {
                		    "ColumnSpan": 6,
		                    "Items": [
        		                { "Label": { "Text": "Улица:" } }
                		    ]
		                },
		                {
        		            "ColumnSpan": 6,
                		    "Items": [
                        		{
		                            "TextBox": {
        		                        "Value": {
                		                    "PropertyBinding": {
                        		                "DataSource": "PatientDataSource",
                                		        "Property": "$.Addresses.$.Street.Name"
		                                    }
        		                        }
                		            }
		                        }
        		            ]
		                }
        		    ]
		        },
				{
		            "Cells": [
        		        {
                		    "ColumnSpan": 6,
		                    "Items": [
        		                { "Label": { "Text": "Дом:" } }
                		    ]
		                },
		                {
        		            "ColumnSpan": 6,
                		    "Items": [
                        		{
		                            "TextBox": {
        		                        "Value": {
                		                    "PropertyBinding": {
                        		                "DataSource": "PatientDataSource",
                                		        "Property": "$.Addresses.$.House"
		                                    }
        		                        }
                		            }
		                        }
        		            ]
		                }
        		    ]
		        }
			]
		}
	},
	"Items": {
		"PropertyBinding": {
			"DataSource": "PatientDataSource",
			"Property": "$.Addresses"
		}
	}
}
```

 

 

