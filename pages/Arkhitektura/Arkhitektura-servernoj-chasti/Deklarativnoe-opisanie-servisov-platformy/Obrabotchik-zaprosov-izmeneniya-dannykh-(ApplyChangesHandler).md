---
layout: default
title: Обработчик запросов изменения данных (ApplyChangesHandler)
position: 
categories: 
tags: 
---

Обработчик предназначен для применения изменений к объекту с указанным идентификатором.

Для понимания принципа работы необходимо ознакомиться с основными положениями, лежащими в основе работы платформы. [[Подробнее|Запрос на создание (модификацию) объекта]]

Рассмотрим подробнее последовательность работы обработчика

|№п/п|Действие|Тип действия|Цель|
|----|--------|------------|----|
|1|Заполнение контекста обработки входящего запроса данных|Логика обработчика|Заполнить контекст вызова прикладного скрипта объектами-помощниками (помощники получения и изменения данных и метаданных конфигурации)|
|2|Заполнение контекста обработчика данными о роутинге, полученными из урла запроса|Логика обработчика|Установить идентификатор конфигурации и объекта метаданных в контексте которых выполняется запрос (для использования прикладным разработчиком в случае необходимости|
|3|Фильтрация входящих событий формирования изменений объекта|Логика пользовательской точки расширения|Отфильтровать вредные/опасные события из входящего запроса|
|4|Получение агрегата из хранилища по указанному идентификатору|Логика обработчика|Получить существующий агрегат из хранилища. Если агрегат с указанным идентификатором найден - возвращается найденный. Если не найден - создается новый агрегат с указанным идентификатором.|
|5|Сохранение событий в первичном хранилище для backup|Логика обработчика|Сохраняем агрегат в Cassandra|
|6|Применение событий изменения объекта к агрегату из хранилища|Логика обработчика|Получить измененный агрегат|
|7|Перевод объекта из состояния в состояние|Логика пользовательской точки расширения|Выполнить перевод объекта из исходного состояния (например, "Temporary") в конечное (например, "Saved"). Действие, выполняемое при переходе объекта из одного состояния в другое, задается декларативно.|
|8|Формирование результата применения изменений|Логика пользовательской точки расширения|Проанализировать результат перевода объекта из состояния в состояние и сформировать результат для отправки пользователю|
|9|Отправка результата применения изменений пользователю|Логика обработчика|Отправить результат обработки|

Выделенные зеленым точки являются точками вызова прикладных скриптов, разрабатываемых прикладным программистом. Подробнее о точках расширения см.[[здесь|Точки расширения бизнес-логики]].

