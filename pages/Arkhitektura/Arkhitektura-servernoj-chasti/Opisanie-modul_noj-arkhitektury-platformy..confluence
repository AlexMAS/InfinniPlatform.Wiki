---
layout: default
title: "Описание модульной архитектуры платформы."
position: 
categories: 
tags: 
---

<p>Платформа поддерживает модульность на уровне проекта (.csproj - файл проекта Visual Studio 2012).</p><p>Структура проектов следующая:</p><p>На текущий момент платформа и конфигурации на базе ее реализованы полностью на основе .NET 4.5 с использованием языка C#.</p><p>В целом платформа на текущий момент разбита на два файла решений (Solution).</p><ol><li>InfinniPlatform.sln</li><li>InfinniConfiguration.sln</li></ol><p>Содержащиеся в решении InfinniPlatform.sln проекты относятся к системным модулям. Поддерживается следующая иерарахия взаимосвязей проектов в решении InfinniPlatform.sln:</p><p>Существует 4 отдельных папки, локализующих отдельные аспекты решения:</p><table><tbody><tr><th>Наименование папки</th><th>Проекты в составе</th><th>Предназначение</th></tr><tr><td>Core</td><td><p>InfinniPlatform.Core</p><p>InfinniPlatform.API</p></td><td><p>Содержит сборки, реализующие самые базовые механизмы платформы.</p><ac:structured-macro ac:name="note"><ac:parameter ac:name="title">ВАЖНО!</ac:parameter><ac:rich-text-body><p>Сборка InfinniPlatform.API содержит механизмы, с помошью которых выполняется прикладная разработка. Данная сборка НЕ МОЖЕТ содержать ссылки на другие сборки из проектов InfinniPlatfom и InfinniConfiguration</p><p>Сборка InfinniPlatform.Core содержит базовые механизмы платформы, которые могут быть использованы ДРУГИМИ модулями платформы (исключая InfinniPlatfom.API). Сборка InfinniPlatform.Core НЕ может ссылаться на другие сборки из проектов InfinniPlatfom и InfinniConfiguration, за исключением проекта InfinniPlatfom.API, на который сборка InfinniPlatform.Core МОЖЕТ ссылаться.</p><p>ЗАПРЕЩАЕТСЯ добавлять ссылки на другие сборки в проекты InfinniPlatform.Core и InfinniPlatfom.API</p></ac:rich-text-body></ac:structured-macro><p>За счет полной независимости InfinniPlatfom.API от других сборок решения, для выполнения прикладной разработки достаточно предоставить клиенту только данную сборку/проект для предоставления возможности разработки клиентом собственных прикладных конфигураций. См. также Описание REST API системы.</p></td></tr><tr><td colspan="1">Designer</td><td colspan="1">Сборки проектов конфигуратора системы</td><td colspan="1"><p>Содержит сборки для реализации десктоп-конфигуратора конфигураций, реализуемых на базе платформы</p><ul><li>Конфигуратор отчетов конфигурации</li><li>Конфигуратор меню конфигурации</li><li>Конфигуратор документов конфигурации</li><li>Конфигуратор справочников конфигурации</li><li>Конфигуратор визуальных представлений конфигурации</li><li>Конфигуратор сценариев конфигурации</li><li>Конфигуратор сервисов конфигурации</li><li>Конфигуратор бизнес-процессов конфигурации</li><li>Административная панель конфигурации</li></ul></td></tr><tr><td colspan="1">Libraries</td><td colspan="1">Список сборок, реализующих высокоуровневые абстракции над сторонними компонентами, используемыми в проекте InfinniPlatfom</td><td colspan="1"><ac:structured-macro ac:name="note"><ac:parameter ac:name="title">ВАЖНО!</ac:parameter><ac:rich-text-body><p>Сборки, содержащиеся в папке Libraries могут ссылаться только на сборки из папки Core и ни на какие другие сборки из проектов InfinniPlatfom и InfinniConfiguration.</p></ac:rich-text-body></ac:structured-macro><p>Содержит список сборок со следующими высокоуровневыми абстракциями над сторонними компонентами:</p><ul><li>InfinniPlatfom.Cassandra - абстракция для работы с БД Cassandra в рамках платформы</li><li>InfinniPlatfom.CORS - абстракция для работы с Cross-Origin Resource Sharing</li><li>InfinniPlatform.Index.ElasticSearch - абстракция для работы с движком ElasticSearch в рамках платформы</li><li>InfinniPlatform.FastReport - абстракция для работы с движком отчетов FastReport</li><li>InfinniPlatform.HealthLevelSeven - абстракция для работы с данными стандарта HL7</li><li>InfinniPlatform.OceanInformatics - абстракция для генерации шаблонов OpenEHR на основе использования сторонней библиотеки Ocean</li><li>InfinniPlatform.OWIN - абстракция на подходом OWIN к хостингу системы на основе Web API 2.0</li><li>InfinniPlatform.RabbitMQ - абстракция над шиной сообщений RabbitMQ для работы с сообщениями в рамках платформы</li><li>InfinniPlatform.SignalR - абстракция над системой рассылки Push-нотификаций SignalR</li><li>InfinniPlatform.WebAPI - абстракция над движком .NET Web API 2.0</li></ul></td></tr><tr><td colspan="1">Tests</td><td colspan="1">Список проектов, в которых содержатся тесты различного типа (модульные, интеграционные, приемочные) для каждого из проектов InfinniPlatform</td><td colspan="1"><ac:structured-macro ac:name="note"><ac:parameter ac:name="title">ВАЖНО!</ac:parameter><ac:rich-text-body><p>Каждому проекту, содержащемуся в любой папке InfinniPlatform необходимо создавать проект, содержащий тесты</p><p>Например: InfiniiPlatform.Core.csproj &lt;=&gt; InfinniPlatfom.Core.Tests.csproj</p></ac:rich-text-body></ac:structured-macro></td></tr><tr><td colspan="1">&lt;В корне решения&gt;</td><td colspan="1">Помимо указанных выше, также существует подмножество проектов, находящихся вне папки. Данные проекты являются реализацией концепций, не зависящих от других сторонних компонентов, а только от других концепций платформы</td><td colspan="1"><ac:structured-macro ac:name="note"><ac:parameter ac:name="title">ВАЖНО!</ac:parameter><ac:rich-text-body><p>Каждый проект в составе решения InfinniPlatform, не относящийся к какой-либо из папок, описанных выше, может ссылаться только на проекты из папки Core либо из папки Libraries. Например, проект InfinniPlatfom.Hosting ссылается на проекты</p><ul><li>Папка Core<ul><li><p>InfinniPlatform.Core</p></li><li><p>InfinniPlatform.API</p></li></ul></li><li>Папка Libraries<ul><li>InfinniPlatform.OWIN - абстракция на подходом OWIN к хостингу системы на основе Web API 2.0</li><li>InfinniPlatfom.CORS - абстракция для работы с Cross-Origin Resource Sharing</li><li>InfinniPlatform.SignalR - абстракция над системой рассылки Push-нотификаций SignalR</li><li>InfinniPlatform.WebAPI - абстракция над движком .NET Web API 2.0</li></ul></li></ul><p>Таким образом, проект InfinniPlatform ссылается только на абстракции над сторонними библиотеками, но не на сами библиотеки, что позволяет иметь потенциальную возможность замены какого-либо из перечисленных компонентов.</p></ac:rich-text-body></ac:structured-macro></td></tr></tbody></table><p>Таким образом, для поддержания модульной независимости системы используется следующая схема зависимостей:</p><p><ac:image ac:align="center"><ri:attachment ri:filename="Struktura.jpg" /></ac:image></p><p>Можно четко выделить три уровня зависимостей системы.</p><ul><li>0 Уровень. Не зависит ни от чего вообще (кроме .NET нативных сборок): InfinniPlatform.API</li><li>1 Уровень. Зависит только от InfinniPlatform.API: InfinniPlatform.Core</li><li>2 Уровень. Зависит от сборок 0 уровня и сборок 1 уровня</li></ul><p>Вышесказанное касается решения InfinniPlatform. В данном решении находятся только проекты, реализующие системную часть платформы.</p><p>Для решения InfinniConfiguration в данный момент структура папок не является настолько же жесткой</p><table><tbody><tr><th>Наименование папки</th><th>Проекты в составе</th><th>Предназначение</th></tr><tr><td>Platform</td><td>Часть проектов решения InfinniPlatform</td><td><p>В настоящее время существует часть legacy проектов (ФИЭМК, конвертер CDA) и тестов, напрямую обращающаяся к абстракциям платформы, что в дальнейшем необходимо устранить путем перехода на JSON настройки конфигураций для всех проектов.</p><p>Помимо этого, существуют системные конфигурации, которые поставляются as is и которым разрешается обращаться к сборкам платформы. Эти конфигурации разрабатываются только разработчиками компании Infinnity Solutions в рамках модернизации ядра платформы и поставляются клиентам без возможности модернизации.</p><ac:structured-macro ac:name="note"><ac:parameter ac:name="title">ВАЖНО!</ac:parameter><ac:rich-text-body><p>Все вновь создаваемые проекты прикланых конфигураций должны содержать ссылку только на проект InfinniPlatfom.API и больше ни на какие проекты из решений InfinniPlatform и InfinniConfiguration</p></ac:rich-text-body></ac:structured-macro></td></tr><tr><td colspan="1">Tests</td><td colspan="1">Содержит проекты с тестами каждой конфигурации (модульными, интеграционными, приемочными)</td><td colspan="1"><ac:structured-macro ac:name="note"><ac:parameter ac:name="title">ВАЖНО!</ac:parameter><ac:rich-text-body><p>Все проекты прикладных конфигураций должны иметь соответствующий проект с тестами, заканчивающийся .Tests)</p></ac:rich-text-body></ac:structured-macro></td></tr><tr><td colspan="1">&lt;В корне проекта&gt;</td><td colspan="1">Содержит модули (проекты csproj) прикладных конфигураций</td><td colspan="1"><p>Существуют системные конфигурации, которые поставляются as is и которым разрешается обращаться к сборкам платформы. Эти конфигурации разрабатываются только разработчиками компании Infinnity Solutions в рамках модернизации ядра платформы и поставляются клиентам без возможности модернизации. К таким конфигурациям относятся:</p><ul><li>InfinniConfiguration.RestfulAPI - предоставляет операции низкоуровневого доступа к объектам платформы<ul><li>Запись любого документа JSON в индекс (строго через использовании абстракции над ElasticSearch)</li><li>Поиск любого документа JSON в индексе(строго через использовании абстракции над ElasticSearch)</li><li>Административные операции с индексом (строго через использовании абстракции над ElasticSearch)</li><li>Запись любого документа в Cassandra (строго через использовании абстракции над Cassandra)</li><li>Поиск любого документа в Cassandra (строго через использовании абстракции над Cassandra)</li><li>итд... Подробнее</li></ul></li><li>InfinniConfiguration.SystemConfig - предоставляет операции высокоуровневого доступа к объектам данных и метаданных прикладных конфигураций. Использует низкоуровневые операции RestAPI для доступа. Подробнее</li><li>InfinniConfiguration.Update - конфигурация, выполняющая административные операции и операции обновления прикладных конфигураций</li></ul><p>Данные конфигурации могут ссылаться на любые сборки из решения InfinniPlatform и не могут ссылаться ни на какие сборки из решения InfinniConfiguration (не могут ссылаться на другие прикладные конфигурации).</p><p>Остальные прикладные конфигурации, не относящиеся к трем вышеуказанным могут ссылаться только на сборку InfinniPlatform.API</p></td></tr></tbody></table><p>С учетом вышесказанного, схема, приведенная выше, преобразуется следующим образом:</p><p><ac:image ac:align="center"><ri:attachment ri:filename="Contours.png" /></ac:image></p><p>&nbsp;</p><p>&nbsp;</p>