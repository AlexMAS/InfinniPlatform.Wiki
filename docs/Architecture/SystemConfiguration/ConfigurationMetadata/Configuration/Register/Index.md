---
layout: default
title: "Register"
position: 1
categories: 
tags: 
---

Регистр.

   

Документы предназначены для хранения информации об объектах предметной области, например, "Пациент", "Медицинский работник", "Осмотр стоматолога" и т.п. В регистрах обычно хранится информация об изменении состояний документов или другая информация, не отражающая объект предметной области, например, "Курс валюты", "Приход и расход товаров на складе", "Количество свободных коек в палате" и т.п. Между документами может устанавливаться семантическая связь, благодаря которой одни документы могут содержать ссылки на другие. Между тем, **документы не могут ссылаться на записи регистра**, поскольку они не являются объектами предметной области, однако записи регистров могут содержать ссылки на другие документы.

С точки зрения технической реализации хранения данных регистр ничем не отличается от документа, однако прикладное применение существенно отличает регистры от документов. В связи с этим здесь и далее **под документом будет пониматься** некий объект, отражающий объект предметной области, а **под записью регистра будут пониматься** сведения, которые зачастую являются функциональным отражением состояния этих объектов. Таким образом, если сам документ имеет прикладную нагрузку, то прикладная нагрузка записи регистра определяется исключительно хранящимися в ней данными. Например, сама запись о курсе валюты не представляет собой ничего существенного, поскольку она не соответствует никакому объекту предметной области. Существенным является лишь то, что в ней содержится информация о курсе валюты на дату. Можно удалить эту запись и создать такую же - это не повлияет на работоспособность системы, поскольку на запись в регистре никто не ссылается.

Документ, на основе которого создаются, обновляются или удаляются записи регистра, называется **регистратором** (или **ведущим документом**). Операция создания, обновления или удаления записей регистра называется **проведением** (или **проводкой**). Соответственно проведение может выполняться при создании, изменении или удалении регистратора. Записи регистров содержат свойства, которые условно можно разделить на **измерения**, **реквизиты** и **ресурсы**. Совокупность измерений задает ключ, которому сопоставлено одно или несколько значений (ресурсов). Реквизиты не формируют ключ, но позволяют включать в записи регистров различную дополнительную информацию. Например, регистр "Курс валюты" содержит измерения "Курс" и "Банк", а также ресурс "Валюта". В этот же регистр мы могли бы добавить, например, реквизит "Автор", в который записывался бы автор изменений курса валюты.

Регистры, записи которых связаны с временем, называются **периодическими**. Если регистр является периодическим, в метаданных регистра должен быть указан **период** (Period). Период (Period) определяет способ создания/изменения записи в регистре. Например, если регистр "Курс валюты" является периодическим и указан Period=[[RegisterPeriod]].Day, тогда при изменении курса валюты в регистр попадет только одна запись; если курс валюты в течении дня поменяется несколько раз, столько же раз обновиться и соответствующая запись в регистре; новая запись в этом регистре будет создана лишь на следующий день, при условии, что курс этой валюты поменяется.    

Описание регистра содержит ссылку на документ ("DocumentId"), который является регистром **(не путать с регистратором)**, и настройки, связанные с проводкой в этот регистр. Каждая запись регистра хранит информацию о регистраторе - документе, на основе которого была создана запись. Если регистр является периодическим, запись регистра будет содержать также информацию о периоде. Логика добавления этой информации в запись регистра является частью соглашения (convention), поэтому в схеме документа регистра ([[DataSchema]]) не нужно описывать эти свойства.

        

```
{
	"id": "Register",
	"description": "Регистр",
	"type": "object",
	"extends": {
		"$ref": "http://demo.infinnity.ru:8081/display/MC/ObjectMetadata"
	},
	"properties": {
		"Type": {
			"description": "Тип регистра",
			"$ref": "http://demo.infinnity.ru:8081/display/MC/RegisterType",
			"required": true
		},
		"DocumentId": {
			"description": "Идентификатор документа регистра",
			"type": "string",
			"required": true
		},
		"Properties": {
			"description": "Список свойств регистра",
			"type": "array",
			"minItems": 2,
			"uniqueItems": true,
			"items": {
				"$ref": "http://demo.infinnity.ru:8081/display/MC/RegisterProperty"
			}
		},
		"Period": {
			"description": "Периодичность записи в регистр",
			"$ref": "http://demo.infinnity.ru:8081/display/MC/RegisterPeriod",
			"default": null
		},
		"Asynchronous": {
			"description": "Запись в регистр осуществляется асинхронно",
			"type": "boolean",
			"default": false
		}
	}
}
```

 

 

